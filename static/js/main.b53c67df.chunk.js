(this.webpackJsonpprojectone=this.webpackJsonpprojectone||[]).push([[0],{368:function(e,t,n){},369:function(e,t,n){},375:function(e,t){},376:function(e,t){},384:function(e,t){},386:function(e,t){},387:function(e,t){},463:function(e,t,n){},467:function(e,t,n){"use strict";n.r(t);var a=n(59),s=n(84),i=n(331),r=n.n(i),c=(n(368),n(369),n(2)),o=n.n(c),l=n(16),u=n(7),d=n(54),h=n(244),f=(n(463),function(){var e=Object(l.a)(o.a.mark((function e(t,n){var a,s,i,r,c,l,f,v,g,m,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=["loss","val_loss","accuracy","val_accuracy"],s={name:"Model Training",styles:{height:"640px"}},i=h.show.fitCallbacks(s,a),512,5500,1e3,r=d.tidy((function(){var e=n.nextTrainBatch(5500);return[e.xs.reshape([5500,28,28,1]),e.labels]})),c=Object(u.a)(r,2),l=c[0],f=c[1],v=d.tidy((function(){var e=n.nextTestBatch(1e3);return[e.xs.reshape([1e3,28,28,1]),e.labels]})),g=Object(u.a)(v,2),m=g[0],b=g[1],e.abrupt("return",t.fit(l,f,{batchSize:512,validationData:[m,b],epochs:20,shuffle:!0,callbacks:i}));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),v=n(3),g=n(10),m=784,b=10,x=65e3,p=Math.floor(54166.66666666667),j=x-p,y=function(){function e(){Object(v.a)(this,e),this.shuffledTrainIndex=void 0,this.shuffledTestIndex=void 0,this.datasetLabels=void 0,this.trainIndices=void 0,this.testIndices=void 0,this.trainImages=void 0,this.datasetImages=void 0,this.testImages=void 0,this.trainLabels=void 0,this.testLabels=void 0,this.shuffledTrainIndex=0,this.shuffledTestIndex=0}return Object(g.a)(e,[{key:"load",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,n,a,s,i,r,c,l,h=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Image,n=document.createElement("canvas"),a=n.getContext("2d"),s=new Promise((function(e,s){t.crossOrigin="",t.onload=function(){t.width=t.naturalWidth,t.height=t.naturalHeight;var s=new ArrayBuffer(20384e4),i=5e3;n.width=t.width,n.height=i;for(var r=0;r<13;r++){var c=new Float32Array(s,r*m*i*4,392e4);null===a||void 0===a||a.drawImage(t,0,r*i,t.width,i,0,0,t.width,i);for(var o=null===a||void 0===a?void 0:a.getImageData(0,0,n.width,n.height),l=0;l<o.data.length/4;l++)c[l]=o.data[4*l]/255}h.datasetImages=new Float32Array(s),e()},t.src="https://storage.googleapis.com/learnjs-data/model-builder/mnist_images.png"})),i=fetch("https://storage.googleapis.com/learnjs-data/model-builder/mnist_labels_uint8"),e.next=7,Promise.all([s,i]);case 7:return r=e.sent,c=Object(u.a)(r,2),c[0],l=c[1],e.t0=Uint8Array,e.next=14,l.arrayBuffer();case 14:e.t1=e.sent,this.datasetLabels=new e.t0(e.t1),this.trainIndices=d.util.createShuffledIndices(p),this.testIndices=d.util.createShuffledIndices(j),this.trainImages=this.datasetImages.slice(0,m*p),this.testImages=this.datasetImages.slice(m*p),this.trainLabels=this.datasetLabels.slice(0,b*p),this.testLabels=this.datasetLabels.slice(b*p);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"nextTrainBatch",value:function(e){var t=this;return this.nextBatch(e,[this.trainImages,this.trainLabels],(function(){return t.shuffledTrainIndex=(t.shuffledTrainIndex+1)%t.trainIndices.length,t.trainIndices[t.shuffledTrainIndex]}))}},{key:"nextTestBatch",value:function(e){var t=this;return this.nextBatch(e,[this.testImages,this.testLabels],(function(){return t.shuffledTestIndex=(t.shuffledTestIndex+1)%t.testIndices.length,t.testIndices[t.shuffledTestIndex]}))}},{key:"nextBatch",value:function(e,t,n){for(var a=new Float32Array(e*m),s=new Uint8Array(e*b),i=0;i<e;i++){var r=n(),c=t[0].slice(r*m,r*m+m);a.set(c,i*m);var o=t[1].slice(r*b,r*b+b);s.set(o,i*b)}return{xs:d.tensor2d(a,[e,m]),labels:d.tensor2d(s,[e,b])}}}]),e}(),I=n(250),w=n(251),k={x:0,y:0},O=function(e){var t=e.width,n=e.height,i=s.useState(!1),r=Object(u.a)(i,2),c=(r[0],r[1],s.useState("#fff")),v=Object(u.a)(c,2),g=v[0],m=v[1],b=s.useRef(null),x=document.getElementById("canvasimg");console.log(x);var p,j=s.useRef();p=function(){var e=d.sequential();return e.add(d.layers.conv2d({inputShape:[28,28,1],kernelSize:3,filters:8,activation:"relu"})),e.add(d.layers.maxPooling2d({poolSize:[2,2]})),e.add(d.layers.conv2d({filters:16,kernelSize:3,activation:"relu"})),e.add(d.layers.maxPooling2d({poolSize:[2,2]})),e.add(d.layers.flatten()),e.add(d.layers.dense({units:128,activation:"relu"})),e.add(d.layers.dense({units:10,activation:"softmax"})),e.compile({optimizer:d.train.adam(),loss:"categoricalCrossentropy",metrics:["accuracy"]}),e}();var O=function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("starting"),t=new y,e.next=4,t.load();case 4:return console.log("data loaded"),h.show.modelSummary({name:"Model Architecture"},p),e.next=8,f(p,t);case 8:console.log("training done"),console.log("hello");case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();s.useEffect((function(){var e;j.current=null===b||void 0===b||null===(e=b.current)||void 0===e?void 0:e.getContext("2d"),j.current.fillStyle="black",j.current.fillRect(0,0,t,n),console.log("Hello")}),[]);var T=function(e){k.x=e.clientX-b.current.offsetLeft,k.y=e.clientY-b.current.offsetTop},S=function(e){1==e.buttons&&(x=document.getElementById("canvasimg"))&&(j.current.beginPath(),j.current.lineWidth=24,j.current.lineCap="round",j.current.strokeStyle="white",j.current.moveTo(k.x,k.y),T(e),j.current.lineTo(k.x,k.y),j.current.stroke(),x.src=b.current.toDataURL("image/png"))};return Object(a.jsxs)("div",{className:"app-box",children:[Object(a.jsxs)("div",{className:"canvas-container",children:[Object(a.jsxs)("div",{className:"color-picker",children:[Object(a.jsx)("div",{className:"color-pick",onClick:function(){return m("#fff")},style:"#fff"===g?{transform:"scale(1.3)"}:{}}),Object(a.jsx)("div",{className:"color-pick black-color",onClick:function(){return m("black")},style:"black"===g?{transform:"scale(1.3)"}:{}}),Object(a.jsx)("div",{className:"eraser",onClick:function(){j.current.clearRect(0,0,t,n),j.current.fillStyle="black",j.current.fillRect(0,0,t,n)},children:Object(a.jsx)(I.a,{icon:w.b,size:"2x"})})]}),Object(a.jsx)("canvas",{ref:b,id:"canvas",width:t,height:n,onMouseDown:T,onMouseEnter:T,onMouseMove:S}),Object(a.jsxs)("div",{className:"bottom-bar",children:[Object(a.jsx)("div",{className:"submit",onClick:function(){var e=d.browser.fromPixels(x,1),t=d.image.resizeBilinear(e,[28,28]).expandDims(0),n=p.predict(t),a=d.argMax(n,1).dataSync();console.log(n),console.log(a),alert(a)},children:Object(a.jsx)(I.a,{icon:w.a,size:"2x"})}),Object(a.jsx)("div",{className:"submit",onClick:O,children:Object(a.jsx)(I.a,{icon:w.c,size:"2x"})})]})]}),Object(a.jsx)("img",{id:"canvasimg",style:{display:"none"},width:280,height:280})]})};var T=function(){return Object(a.jsx)("div",{children:Object(a.jsx)(O,{height:600,width:600})})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,484)).then((function(t){var n=t.getCLS,a=t.getFID,s=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),s(e),i(e),r(e)}))};r.a.render(Object(a.jsx)(T,{}),document.getElementById("root")),S()}},[[467,1,2]]]);
//# sourceMappingURL=main.b53c67df.chunk.js.map